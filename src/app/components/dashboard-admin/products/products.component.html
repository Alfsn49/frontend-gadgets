<section class="px-4 md:px-8 lg:px-16">
  <div
    class="mt-10 text-center flex flex-col md:flex-row items-center justify-center space-y-4 md:space-y-0 md:space-x-6"
  >
    <img
      src="https://amkt.ppg.br/wp-content/uploads/2019/01/Gif.gif"
      alt="√çcono"
      class="w-16 h-16 justify-center rounded-full md:w-60 md:h-60 lg:w-24 lg:h-24"
    />
  </div>
  <div
    class="mt-10 text-center flex flex-col md:flex-row items-center justify-center space-y-4 md:space-y-0 md:space-x-6"
  >
    <h1
      class="text-3xl font-extrabold leading-none tracking-tight text-gray-900 sm:text-4xl md:text-4xl lg:text-5xl"
    >
      Gesti√≥n de Productos
    </h1>
  </div>

  <div class="mt-10 flex justify-center items-center">
    <button
      (click)="openModalCreate()"
      class="flex items-center justify-center bg-orange-400 text-white py-3 px-6 rounded-2xl hover:bg-orange-500 text-sm md:text-base lg:text-lg shadow-md"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 24 24"
        width="24"
        height="24"
        fill="none"
        class="mr-2"
      >
        <path
          d="M12 8V16M16 12L8 12"
          stroke="currentColor"
          stroke-width="1.5"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
        <circle
          cx="12"
          cy="12"
          r="10"
          stroke="currentColor"
          stroke-width="1.5"
        />
      </svg>
      Agregar
    </button>
  </div>

  <div class="mt-8 overflow-x-auto">
    <div class="text-search">
      <mat-form-field class="example-full-width">
        <mat-label>Productos a Buscar</mat-label>
        <input
          matInput
          placeholder="Ej. Yu-gi-oh!"
          value="Yu-gi-oh"
          [(ngModel)]="searchText"
          (keyup)="onInputChange()"
        />
      </mat-form-field>
    </div>

    <div class="mt-6 overflow-x-auto border rounded-xl shadow-md">
      <table
        matSort
        (matSortChange)="sortData($event)"
        mat-table
        [dataSource]="dataSource"
        class="w-full min-w-max text-sm text-left rtl:text-right text-gray-500 dark:text-gray-900 border border-dark-900 mat-elevation-z8"
      >
        <!-- ID Column -->
        <ng-container matColumnDef="id">
          <th
            mat-sort-header="id"
            mat-header-cell
            *matHeaderCellDef
            class="px-6 py-3 bg-white border-b border-orange-500"
          >
            id
          </th>
          <td
            mat-cell
            *matCellDef="let productos"
            class="px-6 py-4 text-sm font-medium text-gray-700 whitespace-nowrap"
          >
            <a
              [routerLink]="[
                '/admin/dashboard/specific/education-programs',
                productos.id,
              ]"
              class="text-orange-500 text-base hover:underline"
            >
              {{ productos.id }}
            </a>
          </td>
        </ng-container>

        <!-- Nombre Column -->
        <ng-container matColumnDef="name">
          <th
            mat-sort-header="name"
            mat-header-cell
            *matHeaderCellDef
            class="px-6 py-3 bg-white border-b border-orange-500"
          >
            Nombre
          </th>
          <td
            mat-cell
            *matCellDef="let productos"
            class="px-6 py-4 text-sm text-gray-500 whitespace-nowrap"
          >
            {{ productos.name }}
          </td>
        </ng-container>

        <ng-container matColumnDef="image">
          <th
            mat-sort-header="image"
            mat-header-cell
            *matHeaderCellDef
            class="px-6 py-3 bg-white border-b border-orange-500"
          >
            Imagen
          </th>
          <td
            mat-cell
            *matCellDef="let productos"
            class="px-6 py-4 text-sm text-gray-500 whitespace-nowrap"
          >
            <img
              [src]="productos.image"
              alt="{{ productos.name }}"
              class="w-20 h-20 object-cover rounded-md"
            />
          </td>
        </ng-container>
        

        <ng-container matColumnDef="cardCode">
          <th
            mat-sort-header="cardCode"
            mat-header-cell
            *matHeaderCellDef
            class="px-6 py-3 bg-white border-b border-orange-500"
          >
            C√≥digo Carta
          </th>
          <td
            mat-cell
            *matCellDef="let productos"
            class="px-6 py-4 text-sm text-gray-500 whitespace-nowrap"
          >
            {{ productos.name }}
          </td>
        </ng-container>

        <ng-container matColumnDef="stock">
          <th
            mat-sort-header="stock"
            mat-header-cell
            *matHeaderCellDef
            class="px-6 py-3 bg-white border-b border-orange-500"
          >
            Stock
          </th>
          <td
            mat-cell
            *matCellDef="let productos"
            class="px-6 py-4 text-sm text-gray-500 whitespace-nowrap"
          >
            {{ productos.stock }}
          </td>
        </ng-container>

        <ng-container matColumnDef="price">
          <th
            mat-sort-header="price"
            mat-header-cell
            *matHeaderCellDef
            class="px-6 py-3 bg-white border-b border-orange-500"
          >
            Precio
          </th>
          <td
            mat-cell
            *matCellDef="let productos"
            class="px-6 py-4 text-sm text-gray-500 whitespace-nowrap"
          >
            {{ productos.price }}
          </td>
        </ng-container>

        <ng-container matColumnDef="description">
          <th
            mat-sort-header="description"
            mat-header-cell
            *matHeaderCellDef
            class="px-6 py-3 bg-white border-b border-orange-500"
          >
            Descripci√≥n
          </th>
          <td
            mat-cell
            *matCellDef="let productos"
            class="px-6 py-4 text-sm text-gray-500 whitespace-nowrap"
          >
            {{ productos.description }}
          </td>
        </ng-container>

        <ng-container matColumnDef="categoria">
          <th
            mat-sort-header="categoria"
            mat-header-cell
            *matHeaderCellDef
            class="px-6 py-3 bg-white border-b border-orange-500"
          >
            Categorias
          </th>
          <td
            mat-cell
            *matCellDef="let productos"
            class="px-6 py-4 text-sm text-gray-500 whitespace-nowrap"
          >
            {{ productos.subCategory.category.name }}
          </td>
        </ng-container>

        <ng-container matColumnDef="subCategoria">
          <th
            mat-sort-header="subCategoria"
            mat-header-cell
            *matHeaderCellDef
            class="px-6 py-3 bg-white border-b border-orange-500"
          >
            Sub Categorias
          </th>
          <td
            mat-cell
            *matCellDef="let productos"
            class="px-6 py-4 text-sm text-gray-500 whitespace-nowrap"
          >
            {{ productos.subCategory.name }}
          </td>
        </ng-container>

        <ng-container matColumnDef="marca">
          <th
            mat-sort-header="marca"
            mat-header-cell
            *matHeaderCellDef
            class="px-6 py-3 bg-white border-b border-orange-500"
          >
            Marca
          </th>
          <td
            mat-cell
            *matCellDef="let productos"
            class="px-6 py-4 text-sm text-gray-500 whitespace-nowrap"
          >
            {{ productos.brand.name }}
          </td>
        </ng-container>

        <ng-container matColumnDef="set">
          <th
            mat-sort-header="set"
            mat-header-cell
            *matHeaderCellDef
            class="px-6 py-3 bg-white border-b border-orange-500"
          >
            Set
          </th>
          <td
            mat-cell
            *matCellDef="let productos"
            class="px-6 py-4 text-sm text-gray-500 whitespace-nowrap"
          >
            {{ productos.set.name }}
          </td>
        </ng-container>

        <!-- Acciones Column -->
        <ng-container matColumnDef="actions">
          <th
            mat-header-cell
            *matHeaderCellDef
            class="px-6 py-3 bg-white border-b border-orange-500 items-center"
          >
            Acciones
          </th>
          <td mat-cell *matCellDef="let productos" class="">
            <!-- Bot√≥n editar -->
            <button
              (click)="openModalEdit(productos)"
              class="p-2 bg-sky-200 rounded-xl hover:bg-sky-400 transition relative group"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
                width="24"
                height="24"
                color="#000000"
                fill="none"
              >
                <path
                  d="M16.9459 3.17305C17.5332 2.58578 17.8268 2.29215 18.1521 2.15173C18.6208 1.94942 19.1521 1.94942 19.6208 2.15173C19.946 2.29215 20.2397 2.58578 20.8269 3.17305C21.4142 3.76032 21.7079 4.05395 21.8483 4.37925C22.0506 4.8479 22.0506 5.37924 21.8483 5.84789C21.7079 6.17319 21.4142 6.46682 20.8269 7.05409L15.8054 12.0757C14.5682 13.3129 13.9496 13.9315 13.1748 14.298C12.4 14.6645 11.5294 14.7504 9.78823 14.9222L9 15L9.07778 14.2118C9.24958 12.4706 9.33549 11.6 9.70201 10.8252C10.0685 10.0504 10.6871 9.43183 11.9243 8.19464L16.9459 3.17305Z"
                  stroke="currentColor"
                  stroke-width="1.5"
                  stroke-linejoin="round"
                />
                <path
                  d="M6 15H3.75C2.7835 15 2 15.7835 2 16.75C2 17.7165 2.7835 18.5 3.75 18.5H13.25C14.2165 18.5 15 19.2835 15 20.25C15 21.2165 14.2165 22 13.25 22H11"
                  stroke="currentColor"
                  stroke-width="1.5"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
              <div
                class="absolute hidden group-hover:block bg-gray-700 text-white text-xs rounded py-1 px-2 bottom-full mb-1 left-1/2 transform -translate-x-1/2"
              >
                Editar
              </div>
            </button>
            <button
              (click)="openModalDelete(productos.id)"
              class="p-2 bg-red-200 rounded-xl hover:bg-red-400 transition relative group"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
                width="24"
                height="24"
                color="#000000"
                fill="none"
              >
                <path
                  d="M19.5 5.5L18.8803 15.5251C18.7219 18.0864 18.6428 19.3671 18.0008 20.2879C17.6833 20.7431 17.2747 21.1273 16.8007 21.416C15.8421 22 14.559 22 11.9927 22C9.42312 22 8.1383 22 7.17905 21.4149C6.7048 21.1257 6.296 20.7408 5.97868 20.2848C5.33688 19.3626 5.25945 18.0801 5.10461 15.5152L4.5 5.5"
                  stroke="currentColor"
                  stroke-width="1.5"
                  stroke-linecap="round"
                />
                <path
                  d="M3 5.5H21M16.0557 5.5L15.3731 4.09173C14.9196 3.15626 14.6928 2.68852 14.3017 2.39681C14.215 2.3321 14.1231 2.27454 14.027 2.2247C13.5939 2 13.0741 2 12.0345 2C10.9688 2 10.436 2 9.99568 2.23412C9.8981 2.28601 9.80498 2.3459 9.71729 2.41317C9.32164 2.7167 9.10063 3.20155 8.65861 4.17126L8.05292 5.5"
                  stroke="currentColor"
                  stroke-width="1.5"
                  stroke-linecap="round"
                />
              </svg>
              <div
                class="absolute hidden group-hover:block bg-gray-700 text-white text-xs rounded py-1 px-2 bottom-full mb-1 left-1/2 transform -translate-x-1/2"
              >
                Eliminar
              </div>
            </button>
          </td>
        </ng-container>

        <!-- Header y Row -->
        <tr
          mat-header-row
          *matHeaderRowDef="displayedColumns"
          class="bg-white text-black-200"
        ></tr>
        <tr
          mat-row
          *matRowDef="let row; columns: displayedColumns"
          class="bg-white border-b border-orange-500 hover:bg-orange-300"
        ></tr>
      </table>
    </div>
    <div class="flex justify-end mt-4">
      <mat-paginator
        [pageSizeOptions]="[5, 10, 20]"
        showFirstLastButtons
        aria-label="Select page of periodic elements"
      >
      </mat-paginator>
    </div>
  </div>
</section>

@if (modalCreate) {
    <section class="modal fixed inset-0 bg-gray-900 bg-opacity-75 z-50 flex items-center justify-center p-4">
        <div class="fixed inset-0 flex items-center justify-center bg-gray-900 bg-opacity-50 z-50 px-4 sm:px-8">
          <div class="bg-white p-8 rounded-3xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto relative">
            <!-- Bot√≥n cerrar -->
            <button
              (click)="closeModalCreate()"
              class="absolute top-3 right-3 bg-gray-300 text-gray-700 w-10 h-10 flex items-center justify-center rounded-full hover:bg-red-500 hover:text-white transition"
            >
              &times;
            </button>
      
            <!-- T√≠tulo + √≠cono -->
            <div class="flex items-center justify-center gap-4 text-center mb-6">
              <img
                src="https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExbndoZzEzemx0NGxvYnVzeGpodGxnaDh0OW5ob3ZkeWszbzJ6aGtsdiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9cw/S7JlIq8ccjl3vg3ykH/giphy.gif"
                alt="√çcono"
                class="h-12 w-14"
              />
              <h2 class="text-gray-800 text-2xl font-bold">
                Registrar Productos
              </h2>
            </div>
      
            <!-- Formulario -->
            <form
              class="grid grid-cols-1 md:grid-cols-2 gap-6"
              [formGroup]="createForm"
              (ngSubmit)="onSubmitCreate()"
            >
              <!-- Nombre -->
              <div class="col-span-1">
                <label class="block text-sm font-semibold text-gray-700 mb-1">üßë‚Äçüíº Nombre *</label>
                <input #nameInput (keydown.enter)="handleEnterOrSubmitCreate('nameInput',subCategoryInput)" formControlName="name" type="text" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:outline-none transition duration-200"
                  [ngClass]="{
                    'border-gray-300 focus:ring-orange-500': !createForm.get('name')?.invalid || !createForm.get('name')?.touched,
                    'border-red-500 focus:ring-red-500': createForm.get('name')?.invalid && createForm.get('name')?.touched
                  }" placeholder="Ingrese el nombre" maxlength="50" />
                @if (createForm.get('name')?.invalid && createForm.get('name')?.touched) {
                  <div class="text-sm text-red-600 mt-1">
                    <span *ngIf="createForm.get('name')?.errors?.['required']">El nombre es obligatorio.</span>
                    <span *ngIf="createForm.get('name')?.errors?.['maxlength']">M√°ximo 100 caracteres permitidos.</span>
                  </div>
                }
              </div>
      
              <!-- Subcategor√≠a -->
              <div class="col-span-1">
                <label class="block text-sm font-semibold text-gray-700 mb-1">üßë‚Äçüíº SubCategor√≠a *</label>
                <select #subCategoryInput 
                  (keydown.enter)="handleEnterOrSubmitCreate('subCategoryInput',brandInput)"
                formControlName="subCategoryId" class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"
                  (change)="onSelectSubCategory($event)">
                  <option value="" disabled selected>Seleccione una sub categor√≠a</option>
                  <option *ngFor="let subcategory of subCategories" [value]="subcategory.id">{{ subcategory.name }}</option>
                </select>
                @if (createForm.get('subCategoryId')?.invalid && createForm.get('subCategoryId')?.touched) {
                  <div class="text-sm text-red-600 mt-1">
                    <span *ngIf="createForm.get('subCategoryId')?.errors?.['required']">La categoria es obligatorio.</span>
                  </div>
                }
              </div>
      
              <!-- Marca -->
              <div class="col-span-1">
                <label class="block text-sm font-semibold text-gray-700 mb-1">üßë‚Äçüíº Marca *</label>
                <select #brandInput  
                  (keydown.enter)="handleEnterOrSubmitCreate('brandInput',setInput)"
                formControlName="brandId" class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"
                  (change)="onSelectBrand($event)">
                  <option value="" disabled selected>Seleccione una marca</option>
                  <option *ngFor="let brand of brands" [value]="brand.id">{{ brand.name }}</option>
                </select>
                @if (createForm.get('brandId')?.invalid && createForm.get('brandId')?.touched) {
                  <div class="text-sm text-red-600 mt-1">
                    <span *ngIf="createForm.get('brandId')?.errors?.['required']">La marca es obligatorio.</span>
                  </div>
                }
              </div>
      
              <!-- Set -->
              <div class="col-span-1">
                <label class="block text-sm font-semibold text-gray-700 mb-1">üßë‚Äçüíº Set *</label>
                <select #setInput 
                  (keydown.enter)="handleEnterOrSubmitCreate('setInput',fileInput)"
                formControlName="setId" class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500" 
                  (change)="onSelectSet($event)" >
                  <option value="" disabled selected>Seleccione un Set</option>
                  <option *ngFor="let set of sets" [value]="set.id">{{ set.name }}</option>
                </select>
                @if (createForm.get('setId')?.invalid && createForm.get('setId')?.touched) {
                  <div class="text-sm text-red-600 mt-1">
                    <span *ngIf="createForm.get('setId')?.errors?.['required']">El set es obligatorio.</span>
                  </div>
                }
              </div>
      
              <!-- Imagen -->
              <div class="col-span-2">
                <label class="block mb-2 text-sm font-medium text-gray-900">Imagen del Producto</label>
                <div class="w-full p-4 border-2 border-dashed border-gray-400 text-center cursor-pointer relative"
                  (dragover)="onDragOver($event)" (drop)="onDrop($event)" (click)="fileInput.click()"
                  [class.border-cyan-500]="isDragging" [class.bg-gray-100]="isDragging">
                  <input #fileInput 
                  (keydown.enter)="handleEnterOrSubmitCreate('fileInput',priceInput)"
                  type="file" (change)="onFileSelected($event)" accept="image/png, image/jpeg" hidden />
                  <p *ngIf="!previewUrl" class="text-gray-600">Arrastra una imagen aqu√≠ o haz clic para seleccionar</p>
                  <img #fileInput *ngIf="previewUrl" [src]="previewUrl" alt="Previsualizaci√≥n" class="max-w-xs mx-auto mt-4 rounded-lg" />
                </div>

              </div>
      
              <!-- Precio -->
              <div class="col-span-1">
                <label class="block text-sm font-semibold text-gray-700 mb-1">üßë‚Äçüíº Precio *</label>
                <input #priceInput 
                  (keydown.enter)="handleEnterOrSubmitCreate('priceInput',stockInput)"
                formControlName="price" type="number" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:outline-none transition duration-200"
                  placeholder="Ingrese el precio" />
                @if (createForm.get('price')?.invalid && createForm.get('price')?.touched) {
                  <div class="text-sm text-red-600 mt-1">
                    <span *ngIf="createForm.get('price')?.errors?.['required']">El precio es obligatorio.</span>
                    <span *ngIf="createForm.get('price')?.errors?.['min']">El precio debe ser mayor a 0.</span>

                    <span *ngIf="createForm.get('price')?.errors?.['pattern']">El precio debe ser un n√∫mero positivo.</span>
                  </div>
                  }
              </div>
      
              <!-- Stock -->
              <div class="col-span-1">
                <label class="block text-sm font-semibold text-gray-700 mb-1">üßë‚Äçüíº Stock *</label>
                <input #stockInput 
                  (keydown.enter)="handleEnterOrSubmitCreate('stockInput',cardCodeInput)" 
                formControlName="stock" type="number" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:outline-none transition duration-200"
                  placeholder="Cantidad en stock" />
                @if (createForm.get('stock')?.invalid && (createForm.get('stock')?.touched || createForm.get('stock')?.dirty)) {
  <div class="text-sm text-red-600 mt-1">
    <span *ngIf="createForm.get('stock')?.errors?.['required']">El stock es obligatorio.</span>
    <span *ngIf="createForm.get('stock')?.errors?.['min']">El stock debe ser mayor a 0.</span>
    <span *ngIf="createForm.get('stock')?.errors?.['pattern']">El stock debe tener numeros enteros</span>
  </div>
    
}
              </div>
      
              <!-- C√≥digo -->
              <div class="col-span-1">
                <label class="block text-sm font-semibold text-gray-700 mb-1">üßë‚Äçüíº C√≥digo de la carta *</label>
                <input #cardCodeInput 
                  (keydown.enter)="handleEnterOrSubmitCreate('cardCodeInput',descriptionInput)"
                formControlName="cardCode" type="text" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:outline-none transition duration-200"
                  placeholder="C√≥digo" />
                @if (createForm.get('cardCode')?.invalid && createForm.get('cardCode')?.touched) {
                  <div class="text-sm text-red-600 mt-1">
                    <span *ngIf="createForm.get('cardCode')?.errors?.['required']">El c√≥digo es obligatorio.</span>
                    </div>
                  }
              </div>
      
              <!-- Descripci√≥n -->
              <div class="col-span-1">
                <label class="block text-sm font-semibold text-gray-700 mb-1">üßë‚Äçüíº Descripci√≥n *</label>
                <textarea #descriptionInput 
                  (keydown.enter)="handleEnterOrSubmitCreate('descriptionInput',submitInput)"
                formControlName="description" rows="3" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:outline-none transition duration-200"
                  placeholder="Descripci√≥n del producto"></textarea>
                @if (createForm.get('description')?.invalid && createForm.get('description')?.touched) {
                  <div class="text-sm text-red-600 mt-1">
                    <span *ngIf="createForm.get('description')?.errors?.['required']">La descripci√≥n es obligatoria.</span>
                  </div>
                }
              </div>
      
              <!-- Bot√≥n -->
              <div class="col-span-2 text-center">
                <button #submitInput
                [disabled]="createForm.invalid || isSubmitting"
                type="submit"
                  class="bg-green-500 text-white px-6 py-2 rounded-full hover:bg-green-600 transition-transform transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed">
                  {{ isSubmitting ? 'Registrando...' : 'Registrar Producto' }}
                </button>
              </div>
            </form>
          </div>
        </div>
      </section>
      
}

@if(modalEditar){
  <section class="modal fixed inset-0 bg-gray-900 bg-opacity-75 z-50 flex items-center justify-center p-4">
        <div class="fixed inset-0 flex items-center justify-center bg-gray-900 bg-opacity-50 z-50 px-4 sm:px-8">
          <div class="bg-white p-8 rounded-3xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto relative">
            <!-- Bot√≥n cerrar -->
            <button
              (click)="closeModalEdit()"
              class="absolute top-3 right-3 bg-gray-300 text-gray-700 w-10 h-10 flex items-center justify-center rounded-full hover:bg-red-500 hover:text-white transition"
            >
              &times;
            </button>
      
            <!-- T√≠tulo + √≠cono -->
            <div class="flex items-center justify-center gap-4 text-center mb-6">
              <img
                src="https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExbndoZzEzemx0NGxvYnVzeGpodGxnaDh0OW5ob3ZkeWszbzJ6aGtsdiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9cw/S7JlIq8ccjl3vg3ykH/giphy.gif"
                alt="√çcono"
                class="h-12 w-14"
              />
              <h2 class="text-gray-800 text-2xl font-bold">
                Editar de Productos
              </h2>
            </div>
      
            <!-- Formulario -->
            <form
              class="grid grid-cols-1 md:grid-cols-2 gap-6"
              [formGroup]="editForm"
              (ngSubmit)="onSubmitEdit()"
            >
              <!-- Nombre -->
              <div class="col-span-1">
                <label class="block text-sm font-semibold text-gray-700 mb-1">üßë‚Äçüíº Nombre *</label>
                <input #nameInput 
                  (keydown.enter)="handleEnterOrSubmitEdit('nameInput',subCategoryInput)"
                formControlName="name" type="text" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:outline-none transition duration-200"
                  [ngClass]="{
                    'border-gray-300 focus:ring-orange-500': !editForm.get('name')?.invalid || !editForm.get('name')?.touched,
                    'border-red-500 focus:ring-red-500': editForm.get('name')?.invalid && editForm.get('name')?.touched
                  }" placeholder="Ingrese el nombre" maxlength="100" />
                @if (editForm.get('name')?.invalid && editForm.get('name')?.touched) {
                  <div class="text-sm text-red-600 mt-1">
                    <span *ngIf="createForm.get('name')?.errors?.['required']">El nombre es obligatorio.</span>
                    <span *ngIf="createForm.get('name')?.errors?.['maxlength']">M√°ximo 100 caracteres permitidos.</span>
                  </div>
                }
              </div>
      
              <!-- Subcategor√≠a -->
              <div class="col-span-1">
                <label class="block text-sm font-semibold text-gray-700 mb-1">üßë‚Äçüíº SubCategor√≠a *</label>
                <select #subCategoryInput formControlName="subCategoryId" class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"
                  (change)="onSelectSubCategory($event)">
                  <option value="" disabled selected>Seleccione una sub categor√≠a</option>
                  <option *ngFor="let subcategory of subCategories" [value]="subcategory.id">{{ subcategory.name }}</option>
                </select>
                @if (editForm.get('subCategoryId')?.invalid && editForm.get('subCategoryId')?.touched) {
                  <div class="text-sm text-red-600 mt-1">
                    <span *ngIf="createForm.get('subCategoryId')?.errors?.['required']">La categoria es obligatorio.</span>
                  </div>
                }
              </div>
      
              <!-- Marca -->
              <div class="col-span-1">
                <label class="block text-sm font-semibold text-gray-700 mb-1">üßë‚Äçüíº Marca *</label>
                <select #brandInput formControlName="brandId" class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"
                  (change)="onSelectBrand($event)">
                  <option value="" disabled selected>Seleccione una marca</option>
                  <option *ngFor="let brand of brands" [value]="brand.id">{{ brand.name }}</option>
                </select>
                @if (editForm.get('brandId')?.invalid && editForm.get('brandId')?.touched) {
                  <div class="text-sm text-red-600 mt-1">
                    <span *ngIf="createForm.get('brandId')?.errors?.['required']">La marca es obligatorio.</span>
                  </div>
                }
              </div>
      
              <!-- Set -->
              <div class="col-span-1">
                <label class="block text-sm font-semibold text-gray-700 mb-1">üßë‚Äçüíº Set *</label>
                <select #setInput formControlName="setId" class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"
                (change)="onSelectSet($event)" 
                  >
                  <option value="" disabled>Seleccione un Set</option>
                  <option *ngFor="let set of sets" [value]="set.id">{{ set.name }}</option>
                </select>
                @if (editForm.get('setId')?.invalid && editForm.get('setId')?.touched) {
                  <div class="text-sm text-red-600 mt-1">
                    <span *ngIf="createForm.get('setId')?.errors?.['required']">El set es obligatorio.</span>
                  </div>
                }
              </div>
      
              <!-- Imagen -->
              <div class="col-span-2">
                <label class="block mb-2 text-sm font-medium text-gray-900">Imagen del Producto</label>
                <div class="w-full p-4 border-2 border-dashed border-gray-400 text-center cursor-pointer relative"
                  (dragover)="onDragOver($event)" (drop)="onDrop($event)" (click)="fileInput.click()"
                  [class.border-cyan-500]="isDragging" [class.bg-gray-100]="isDragging">
                  <input #fileInput type="file" (change)="onFileSelected($event)" accept="image/png, image/jpeg" hidden />
                  <p *ngIf="!previewUrl" class="text-gray-600">Arrastra una imagen aqu√≠ o haz clic para seleccionar</p>
                  <img *ngIf="previewUrl" [src]="previewUrl" alt="Previsualizaci√≥n" class="max-w-xs mx-auto mt-4 rounded-lg" />
                </div>
              </div>
      
              <!-- Precio -->
              <div class="col-span-1">
                <label class="block text-sm font-semibold text-gray-700 mb-1">üßë‚Äçüíº Precio *</label>
                <input #priceInput formControlName="price" type="number" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:outline-none transition duration-200"
                  placeholder="Ingrese el precio" />
                  @if (editForm.get('price')?.invalid && editForm.get('price')?.touched) {
                  <div class="text-sm text-red-600 mt-1">
                    <span *ngIf="editForm.get('price')?.errors?.['required']">El precio es obligatorio.</span>
                    <span *ngIf="editForm.get('price')?.errors?.['min']">El precio debe ser mayor a 0.</span>

                    <span *ngIf="editForm.get('price')?.errors?.['pattern']">El precio debe ser un n√∫mero positivo.</span>
                  </div>
                  }
              </div>
      
              <!-- Stock -->
              <div class="col-span-1">
                <label class="block text-sm font-semibold text-gray-700 mb-1">üßë‚Äçüíº Stock *</label>
                <input #stockInput formControlName="stock" type="number" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:outline-none transition duration-200"
                  placeholder="Cantidad en stock" />
                  @if (editForm.get('stock')?.invalid && (editForm.get('stock')?.touched || editForm.get('stock')?.dirty)) {
  <div class="text-sm text-red-600 mt-1">
    <span *ngIf="editForm.get('stock')?.errors?.['required']">El stock es obligatorio.</span>
    <span *ngIf="editForm.get('stock')?.errors?.['min']">El stock debe ser mayor a 0.</span>
    <span *ngIf="editForm.get('stock')?.errors?.['pattern']">El stock debe tener numeros enteros</span>
  </div>
}
              </div>
              <!-- C√≥digo -->
              <div class="col-span-1">
                <label class="block text-sm font-semibold text-gray-700 mb-1">üßë‚Äçüíº C√≥digo de la carta *</label>
                <input #cardInput formControlName="cardCode" type="text" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:outline-none transition duration-200"
                  placeholder="C√≥digo" />
                @if (editForm.get('cardCode')?.invalid && editForm.get('cardCode')?.touched) {
                  <div class="text-sm text-red-600 mt-1">
                    <span *ngIf="editForm.get('cardCode')?.errors?.['required']">El c√≥digo es obligatorio.</span>
                  </div>
                }
              </div>
      
              <!-- Descripci√≥n -->
              <div class="col-span-1">
                <label class="block text-sm font-semibold text-gray-700 mb-1">üßë‚Äçüíº Descripci√≥n *</label>
                <textarea #descriptionInput formControlName="description" rows="3" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:outline-none transition duration-200"
                  placeholder="Descripci√≥n del producto"></textarea>

                @if (editForm.get('description')?.invalid && editForm.get('description')?.touched) {
                  <div class="text-sm text-red-600 mt-1">
                    <span *ngIf="editForm.get('description')?.errors?.['required']">La descripci√≥n es obligatoria.</span>
                  </div>
                }
              </div>
      
              <!-- Bot√≥n -->
              <div class="col-span-2 text-center">
                <button #submitInput 
                [disabled]="editForm.invalid || isSubmitting"
                type="submit"
                  class="bg-green-500 text-white px-6 py-2 rounded-full hover:bg-green-600 transition-transform transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed">
                  {{ isSubmitting ? 'Actualizando...' : 'Actualizar Producto' }}
                </button>
              </div>
            </form>
          </div>
        </div>
      </section>
}

@if(modalEliminar){
  <section 
class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 modal">
<div class="bg-white p-6 rounded-lg shadow-2xl max-w-xs md:max-w-sm w-full relative border border-gray-300">
  <button (click)="closeModalDelete()"
    class="absolute top-2 right-2 bg-gray-100 text-black w-8 h-8 flex items-center justify-center rounded-full hover:bg-red-500 hover:text-white transition">
    &times;
  </button>
  <div class="flex items-center justify-center gap-3 text-center">
    <img src="https://emojitool.com/img/twitter/twemoji-15.0/twemoji-15.0-2366.png" alt="Advertencia"
      class="w-16 h-16">

    <h2 class="text-lg font-bold text-gray-900">Eliminar</h2>
  </div>
  <p class="text-sm text-black mt-4 text-center">
    ¬øEst√°s seguro de que deseas eliminar? <br> <br>
    <span class="text-red-700 font-semibold">Esta acci√≥n no se puede deshacer.</span>
  </p>
  <div class="flex flex-col space-y-2 mt-5">
    <button (click)="openModalConfirmDelete()"
      class="bg-red-600 text-white font-medium rounded-lg px-4 py-2 transition transform hover:scale-105 hover:bg-red-700">
      Confirmar Eliminaci√≥n
    </button>
    <button (click)="closeModalDelete()"
      class="bg-gray-100 text-gray-700 border border-gray-300 font-medium rounded-lg px-4 py-2 transition transform hover:scale-105 hover:bg-gray-200">
      Cancelar
    </button>
  </div>
</div>
</section>
}

@if(modalConfirmarEliminar){
  <section 
class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 modal">
<div class="bg-white p-6 rounded-lg shadow-2xl max-w-xs md:max-w-sm w-full relative border border-gray-300">
  <button (click)="closeModalConfirmDelete()"
    class="absolute top-2 right-2 bg-gray-100 text-black w-8 h-8 flex items-center justify-center rounded-full hover:bg-red-500 hover:text-white transition">
    &times;
  </button>
  <div class="flex items-center justify-center">
    <img src="https://assets-v2.lottiefiles.com/a/e09820ea-116b-11ee-8e93-4f2a1602d144/VSOpyqTQGL.gif"
      alt="Advertencia" class="w-16 h-16">
  </div>
  <h2 class="text-lg font-bold text-red-600 text-center mt-2">Confirmar Eliminaci√≥n</h2>
  <p class="text-sm text-black mt-3 text-center">
    ¬øRealmente deseas proceder con la eliminaci√≥n de este producto <br><br>
    <span class="text-black font-semibold">Los datos asociados se perder√°n.</span>
  </p>
  <div class="flex flex-col space-y-2 mt-5">
    <button [disabled]="isSubmitting" (click)="onSubmitDelete()"
      class="bg-red-600 text-white px-6 py-2 rounded-full hover:bg-red-700 transition-transform transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed">
      {{ isSubmitting ? 'Eliminando...' : 'Confirmar Eliminaci√≥n' }}
    </button>
    <button (click)="closeModalConfirmDelete()"
      class="bg-gray-100 text-gray-700 border border-gray-300 font-medium rounded-lg px-4 py-2 transition transform hover:scale-105 hover:bg-gray-200">
      Cancelar
    </button>
  </div>
</div>
</section>
}
